#include <math.h>
#include <stdint.h>
#include <stdio.h>

#define N 128

float cosine_similarity(int16_t v1[N], int16_t v2[N]) {
    int32_t dot = 0;
    int32_t norm1 = 0;
    int32_t norm2 = 0;
    for (int i = 0; i < N; i++) {
        dot += v1[i] * v2[i];
        norm1 += v1[i] * v1[i];
        norm2 += v2[i] * v2[i];
    }
    return dot / (sqrtf(norm1) * sqrtf(norm2) + 1e-12f);
}



int main() {
    int16_t enc1[N] = {
        -3885, 2367, 822, -1406, -1090, 488, -3628, -1888, 2937, -2774, 4828, 1773,
        -4861, -3516, 8, 1532, -1449, -3377, -663, -2150, 557, 1879, 1369, 1724,
        -3856, -8331, -1528, -2762, 224, -2354, -1289, 908, -4819, -436, 1144, 3635,
        182, 736, 3514, 1566, -3269, 876, 551, 5407, 4690, 1919, 1061, -1535,
        4767, -4836, 2091, 3491, 3631, -384, 3818, -3707, -131, 2187, -3533, 2184,
        -527, -1373, -1425, -1119, 4139, 2516, -1885, -3393, 5076, -3317, -1182, 3968,
        -2197, -4490, -4539, 2589, 8556, 5786, -3897, 2429, -38, -452, 349, 1474,
        -2729, 713, -1217, 364, 4707, 2379, -922, 4918, -260, 3742, 2073, -865,
        -2986, -1330, -3338, -1744, -163, -1448, 643, 1358, -2942, 2873, -1931, -546,
        -1246, 2418, -1702, 291, 1773, -6432, 5517, 2659, 1374, 3829, 3361, 1153,
        1135, -801, -2551, -3771, 1898, -2176, 2614, -316
    };

    int16_t enc2[N] = {
        -3995, 3150, 2314, -799, -1205, 96, -2540, -2880, 3250, -2373, 5591, 1304,
        -5006, -2904, -531, 2827, -2860, -4484, -365, -2356, 770, 986, 1136, 1280,
        -3368, -7706, -1646, -2799, 999, -2607, -1263, 997, -3886, -90, 725, 3194,
        -520, -773, 4117, 584, -3206, 1028, 953, 5323, 4208, 1626, 1631, -2407,
        4674, -4603, 1984, 3249, 3935, 969, 2184, -5013, 1104, 1384, -3875, 2787,
        156, -3409, 51, 1264, 4629, 2557, -1428, -2654, 4419, -2623, -986, 3360,
        -2531, -3767, -5071, 1617, 10383, 3071, -3411, 2032, -502, -512, 597, 2586,
        -4260, -471, -3312, 515, 5609, 1316, -1190, 4735, 440, 3519, 2289, 647,
        -2449, -898, -1568, -1742, -227, -2255, -209, 829, -3441, 2305, -1072, 142,
        -1571, 1352, -1052, 76, 1804, -6193, 5326, 3582, 1456, 4401, 2655, 1408,
        569, -1564, -1596, -2313, 1718, -850, 2725, 1059
    };

    float dist = cosine_similarity(enc1, enc2);
    printf("Cosine similarity: %f\n", dist);

    return 0;
}

